@[TOC](UI渲染和布局适配) 

# UI渲染和布局适配

## 内存泄漏和内存抖动  
- 内存泄漏：GC在内存吃紧去回收内存的时候，无法回收某一块不再使用的内存。随着时间的推移会导致内存溢出，这种其实就是强引用
- 内存抖动：GC的频率会非常之频繁，不断的开辟和回收大的内存。

## 自定义View代码优化
- 举个例子？（内存优化主要去讲） 去观察，去思考，有意识
- for循环，不断刷新界面，多次调用的情况，通常不要重复创建一些没有必要的对象。解决的方式在某一个地方事先创建好

## UI渲染与界面卡顿
- UI渲染，在一定的时间内必须要测量摆放呈现，
- 怎么解决经常出现的一些情况，不断GC的时候会导致界面卡顿（GC会去占用主线程），在主线程中不要去做耗时的操作
比如点击一个按钮，过了很久才跳过去，怎么解决？onCreate里面做了耗时操作，可以再页面添加一个进度条（先跳过去），
但是一般来讲这种耗时操作只需要出现一次，一定要做一次缓存。（HelloWorld级别），不要在onDraw()里面去做大内存开辟。
- UI渲染问题解决，<font color=red size = 3>绿色两次，淡红3次，深红是4次（一般是由于背景导致的）小事例（要自己去观察，做调整）</font>

## 资源适配
- 参考权威的一些 APK  (Canon , QQ)，一个概念把能够写到res下面的全部写到这个里面，如  字体大小  文本 颜色 等等 （严格执行）

## 布局适配
- 布局的别名问题，以画图的小事例为例子（设计师）   （网上）
- 平板 layout-sw600dp (600dp以上) ，平板会自动去加载这个文件下的布局，如果有需要适配的界面就可以放在这里面
- 竖屏 layout-land ，竖屏情况下会自动去加载这个文件下的布局，如果有需要适配的界面就可以放在这里面

- 版本问题，以 MD 为例  5.0 以下   values的版本别名 ，需要想办法去适配 （values-v21）

- 细节（常用）：wrap_content , match_parent , weight 能不写死的就不写死

### 屏幕

1. 屏幕尺寸，屏幕分辨率，屏幕像素密度

	1.1. 屏幕尺寸：指的是屏幕对角线的长度 5.0 5.1 （并不是特别重要）

	1.2. 屏幕分辨率：指的是在横纵向上的像素点数单位是 px, 1px = 1像素 一般以纵向像素*横向像素，如 1920*1080

	1.3. 屏幕像素密度：指的是每英寸上面的像素点数，单位是dpi ，即 “dot per inch”的缩写，屏幕像素密度与屏幕尺寸和屏幕分辨率有关

Nexus 5   
屏幕 4.95inch  
1920 * 1080  
DPI = 445  
(1920平方 + 1080平方) 开根号  / 4.95 =  445 dp  
480 * 320 3.5 英寸= 160dpi     

2. dp、dip、dpi、sp、px之间的关系

	2.1.  dp、dip 指的是密度无关像素，以160dpi为基准，1dip=1px

	2.2.  sp  google 推荐  12sp以上  12sp  14sp  18sp  22sp 最好不要使用基数，可能会在部分机型上造成精度的丢失  10sp

3. mdpi、hdpi、xhdpi、xxhdpi如何计算区分

	- ldpi     120    240*320
	- mdpi     160dp    320px*480px  1dp = 1px
	- hdpi     240dp    480*800  1dp = 1.5px
	- xhdpi    320    720*1280   1dp = 2px 

在代码中使用的一般都是 px , 一般都需要转换

### 图片适配

- 1套 3 套    drawable  mipmap 区别 官网是讲得非常清楚了，mipmap 主要放图标 .
- 目前市场上的都没有分得太开一般情况下放一套就可以，部分要区分开，放一套的情况下放用户量最多的那个目录下
- 1920 * 1080的图片占用内存分析：(drawable-xxhdpi)11M   (drawable-xhdpi)21M   (drawable-hdpi)35M  
- 特殊情况下相对尺寸较大的一些图，一般需要放三套 如 启动页 ，个人中心背景图等等，还有必须要做Bitmap的优化或者用第三方的图片库去加载




 


      
     
 

